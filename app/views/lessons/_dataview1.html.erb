<div>
<p>Data View</p>


<svg id="ratings">
  <rect></rect>
</svg>
<p>Count <%= @rating_count %> </p>
<script>

// var data = [{value: 0, books: 54},
//             {value: 1, books: 43},
//             {value: 2, books: 41},
//             {value: 3, books: 20},
//             {value: 4, books: 44},
//             {value: 5, books: 33},
//             {value: 6, books: 35}];

var data = gon.ratingvalues;
var barWidth = 15;
var width = (barWidth + 4) * data.length;
var height = 200;

var x = d3.scale.linear().domain([0, data.length + 2]).range([0, width]);
var y = d3.scale.linear().domain([0, 5]).range([0, 180]);

// add the canvas to the DOM
var barDemo = d3.select("#ratings").
  append("svg:svg").
  attr("width", width).
  attr("height", height);

  barDemo.selectAll("rect").
  data(data).
  enter().
  append("svg:rect").
  attr("x", function(datum, index) { return x(index) + barWidth; }).
  attr("y", function(datum) { return height - y(datum.value); }).
  attr("class", "yAxis").
  attr("height", function(datum) { return y(height); }).
  attr("width", barWidth).
  attr("fill", "#2d578b");

  barDemo.selectAll("text").
  data(data).
  enter().
  append("svg:text").
  attr("x", function(datum, index) { return x(index) + barWidth; }).
  attr("y", function(datum) { return height - y(datum.value); }).
  attr("dx", barWidth/2).
  attr("dy", "1em").
  attr("text-anchor", "middle").
  attr("style", "font-size: 8; font-family: Helvetica, sans-serif").
  text(function(datum) { return datum.value;}).
  attr("fill", "white");

  barDemo.selectAll("text.yAxis").
  data(data).
  enter().append("svg:text").
  attr("x", function(datum, index) { return x(index) + barWidth; }).
  attr("y", height).
  attr("dx", -barWidth/2).
  attr("text-anchor", "middle").
  attr("style", "font-size: 8; font-family: Helvetica, sans-serif").
  text(function(datum) { return datum.id;}).
  attr("transform", "translate(0, 18)").
  attr("class", "yAxis");

  </script>

  </div>