
<p>Data View</p>

<div class="container">
<svg id="Aratings">
</svg>
</div>

<p>Count <%= @lesson.students.count %> </p>
<p>Ratings Total <%= @lesson.ratings.count %> </p>
<script>



var data = gon.ratings
var student_count = gon.students


var margin = {top: 10, right: 10, bottom: 20, left: 10};


var width = 800;
var height = 400;
var barWidth = width / data.length - (data.length / 2);

var x = d3.scale.linear().domain([0, data.length]).range([0, width]);
var y = d3.scale.linear().domain([0, 5]).range([0, height]);
var yAxis = d3.scale.linear().domain([0,5]).range([height, 0]);
// add the canvas to the DOM
var barDemo = d3.select("#Aratings").
  append("svg").
  attr("width", width  + margin.right).
  attr("height", height +  margin.bottom);


barDemo.selectAll("rect").
  data(data).
  enter().
  append("rect").
  attr("x", function(datum, index) { return x(index); }).
  attr("y", function(datum) { return height - y(datum.value); }).
  attr("height", function(datum) { return y(height); }).
  attr("width", barWidth).
  attr("fill", "#6fd0ff");


barDemo.selectAll("text").
  data(data).
  enter().
  append("svg:text").
  attr("x", function(datum, index) { return x(index); }).
  attr("y", function(datum) { return height - y(datum.value); }).
  attr("dx", barWidth/2).
  attr("dy", "1em").
  attr("text-anchor", "middle").
  attr("style", "font-size: 12; font-family: Helvetica, sans-serif").
  text(function(datum) { return datum.value;}).
  attr("fill", "black");

yAxis = d3.svg.axis() // generate an axis
.scale(yAxis) // set the range of the axis
.tickSize(1) // width of the ticks
.tickSubdivide(true)
.orient("right"); // have the text labels on the left hand side


barDemo.call(yAxis);







  </script>

